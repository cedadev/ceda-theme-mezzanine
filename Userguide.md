# User Guide

## Understanding the structure

The theme `ceda-theme-mezzanine` is to be used with the [Django](http://www.djangoproject.com)-based [Mezzanine](https://mezzanine.jupo.org) content management system.

Mezzanine itself provides a basic `RichTextPage` content type which can be used to create pages for a website. These `RichTextPage` objects can be arranged in a hierarchy which define the site structure and can also form the basis of a navigation menu for a site. It also provides a `Blog` construct which can be used a news feed, and provides components for uploading and using images within the various pages.
`RichTextPage` objects can be edited using a graphical editor within the admin interface provided by Mezzanine, or can be edited elsewhere and copied-and-pasted in as HTML for finer control of markup.
Mezzanine also provides a set of [Bootstrap](https://getbootstrap.com/docs/3.3/) templates for presenting the basic Mezzanine content types.

The `ceda-theme` and `ceda-theme-django` packages provide the CEDA site styling, adapted for use within any Django app, while the `ceda-theme-mezzanine` provides additional content types to use within Mezzanine.

The Mezzanine content architecture is fully described here, but in summary the basic Mezzanine content type `RichTextPage` has the following editable attributes, some of which are optional:
- __title__ Title to be displayed in page heading
- __status__ (draft/published)
- __published_from__ (date/time)
- __published_to__ (date/time)
- __content__ (`RichTextField`, the main field for page content)
- Tick-boxes to indicate which navigation menu(s) the page should appear in
- __metadata__ section
  - __title__ Optional additional title to be used in the HTML `<title>` tag. If left blank, the main title field will be used
  - __url__ leave blank to have this 'slug' autogenerated from the title, but can be overridden. Note by default this will include a path to reflect the position in the overall Page hierarchy, but this can be over-ridden.
  - __description__ (by default, auto-generated from the Content field but can be over-ridden. Used in HTML `<head>` description.)
  - __keywords__ (optional keywords used in HTML `<head>` section)

So Mezzanine provides all those attributes on its basic `RichTextPage` content type, but this CEDA theme provides a small/manageable number of additional content types, which are fairly generic, but whose use can be customised via templates. It's relatively easy to add new content types as needs are identified. Specific content types AND specific instances of those content types can have their own templates, see Templates, below.

`ceda-theme-mezzanine` content types:

- `Portfolio`
  - Can be used to group together a set of items e.g. projects which are in some way related and can be presented together.
  - Attributes (in addition to those inherited from Page)
    - __content__ (`RichTextField`)
      - Intended as a brief introduction to the PortfolioItems

- `PortfolioItem`
  - An item which belongs to a particular Portfolio.
  - Attributes (in addition to those inherted from Page)
    - __subtitle__ (`CharField`) brief subtitle text for the item
    - __intro__ (`RichTextField`) longer introductory text for the item
    - __content__ (`RichTextField`), inherited from Page: main content
    - __icon__ (`CharField`) a "font-awesome" icon used to represent this item. Choose from the list at http://fontawesome.io/icons/, e.g. `fa-database`. Template may define a default icon to use if none specified.
    - __categories__ optional categories to label item
    - __href__ link to the service / project / thing which this PortfolioItem describes
    - __button_text__ alternative to the default "Learn More" text which will be displayed on the button/link used for _href_
    - __content__ (`RichTextField`, inherited from Page)
    - __person(s)__
    - __image(s)__, with the following attributes:
      - __caption__ (`CharField`), caption to describe the image
      - __is_logo__ (`BooleanField`), identifies this image as *the* logo for the item. Can then be handled differently in templates.
    - __category/ies__, optional categories for labelling items
    

- `HomePage`
  - A special instance of `Page` which can be used as the home page of the site. The url (in metadata section) should be set to `/` for this to be displayed. 
  - Attributes (in addition to those inherited from Page)
    - __leader_text__ (`TextField`) Leader text used in title graphics
    - __button_text__ (`CharField`) Text used on button linking from title graphics
    - __button_link__ (`CharField`) Link used as destination from button in title graphics
    - __icon_box_layout__ Choice of how many icon boxes across page in icon box section (default = "three across")
    - __icon_box(es)__ : These are boxes titled with icons, used to highlight and/or link to particular things on the site or at external locations. They are similar in concept to portfolioitems but more flexible in that they can link directly to something external and don't form part of the site page hierarchy so can be changed regularly to highlight particular things of interest.
      - __icon__ (`CharField`) a "font-awesome" icon used to represent this item. Choose from the list at http://fontawesome.io/icons/, e.g. `fa-database`. Template may define a default icon to use if none specified.
      - __title__ (`CharField`) title of icon item
      - __content__ (`RichTextFiels`) main text content of icon item
      - __link__ (`Charfield`) optional link: if provided, a button can be displayed to navigate to it
    - __slide(s)_: Images used in image slider
      - __heading__ (`CharField`) heading text to display with this slide
      - __subheading__ (`TextField`) sub-heading text to display with this slide
      - __content__ (`TextField`) extended text to display with this slide
      - __button_link__ (`CharField`) text to be displayed on button within slide
      - __image__ image to be used as slide background
      - __custom__ (`TextField`) HTML used to create a custom slide, which would over-ride all the above (check template for required HTML structure)
 
 ## Templates

### Default and custom template location

Templates are applied in Mezzanine based on whether a template with a particular name exists.
By default the template `pages/<contenttype>.html` is used, for example `pages/portfolioitem.html`, but if a custom template exists it will be used instead and will take precedence, for example `pages/services.html` (where "services" is the slug of a `Portfolio`) will take precedence over `pages/portfolio.html`.
Bear in mind when designing the site url structure that the url or slug of a page item (often auto-generated, unless it has been over-ridden) defines where the template is expected to be. So if you move a page instance around within the site hierarchy, be sure to check what it's new url is and make sure there is a template at that path ...or override its url to match where the template is.

### Template structure

Templates are written using Django's template language, making use of `block` structures to enable inheritance and extension of existing templates rather than repetition. So where possible, only the relevant block of a template needs to be defined, to override just that part of the parent template. 

Example: the template `pages/services.html` is a custom template which replaces the default `pages/portfolio.html`, since `services` is an instance of `Portfolio`. Both of these templates extend `pages/page.html` template, and only the `main` block needs to be defined (all other blocks remain unchanged relative to those in the `pages/page.html`).

The template `pages/page.html` is itself quite sparse, since it extends `base.html`, which is the princple template defining the arrangement of the Mezzanine content elements within a default page. "main" is a small block defined within this `base.html`, so expects to be over-ridden by templates for partcular content types and/or instances of those. 
But `base.html` extends `ceda_theme/layout.html` which defines the overall page layout and style (hence why a Django deployment using `ceda_theme_mezzanine` needs to include `ceda_theme` in its `INSTALLED_APPS`. Note the underscores used for actual Python packages as opposed to hyphens for the github project names)

